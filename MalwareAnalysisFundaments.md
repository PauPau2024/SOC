### **Introduction to Malware Analysis**

As a SOC analyst, you will often analyze suspicious files in your daily work routine. With the Malware fundamentals training, the necessary basic information will be learned by introducing the subject of malware analysis.

In this training;

- Definition of malware,
- Malware types,
- Malware analysis approaches,
- How to analyze suspicious files simply

will be taught.

### **Malware Definition and Malware Types**

The word Malware is a word derived from the words **MAL**icious soft**WARE**. It is the name given to software that endangers the security and integrity of systems by targeting a malicious purpose.

Today, cyber threat actors use malicious software to achieve various purposes such as ensuring persistence, damaging systems, demanding ransom. As SOC analyst, we need to analyze suspicious software and understand whether the software is really harmful.

Some types of malware and their descriptions are as follows.

- **Backdoor:** Leaving a backdoor on the device where the malware is installed, it allows the attacker to access the system through this backdoor. For example, by opening a network port connected to the shell, it enables the attacker to connect to the system through this port.
- **Adware:** It often comes with downloaded software, causing unwanted advertisements to be displayed on the device. While not all adware is harmful, some change the default search engine.
- **Ransomware:** It is a type of malware that has been on the world agenda for the last few years. It demands ransom from people by encrypting and exfiltrating all files on the device.
- **Virus:** It is one of the first types of malware seen in the wild. So we see that in daily life, it is often called a virus instead of the term malware. Viruses have a self-replicate feature. It provides persistence by infecting other files on the device.
- **Worm:** Since this type of malware spreads from infected devices to other devices, it is named worm. WannaCry, a worm malware exploiting MS17-010 vulnerability, caused panic around the world.
- **Rootkit:** It is a type of malware that disguises itself by providing access to a high level of authority on the device.
- **RAT (Remote Access Trojan):** It is a type of malware that provides full control over the device to the threat actor.
- **Banking malware:** A type of malware that targets banking applications and causes money to be stolen from the victim.
- **Keylogger:** A type of malware that logs pushed keys and sends this information to attacker.

## **Operating System Fundamentals and Architecture**

Since malware runs on operating systems, malware analysts should have a solid understanding and knowledge of the operating systems.

![](https://ld-images-2.s3.us-east-2.amazonaws.com/Malware+Analysis+Fundamentals/images/monolithic_os_kernel.gif)Malware often takes advantage of the features offered by the operating system, increasing its privileges, making discovery and ensuring persistence.

### **Which Approach Should You Choose When Analyzing Malware?**

There are 2 different approaches to analyzing malware.

1. Static Analysis
2. Dynamic Analysis

## **What is Static Analysis?**

It is the approach of analyzing malicious software by reverse engineering methods without running them.

Generally, by decompile / disassemble the malware, each step that the malware will execute is analyzed, hence the behavior / capacity of the malware can be analyzed.

The information examined during the static analysis is as follows.

1. P.E. (Portable Executable) Headers
2. Imported DLL's
3. Exported DLL's
4. Strings in binary
5. CPU Instructions

## **What is Dynamic Analysis?**

It is the approach that examines the behavior of malicious software on the system by running it.

In dynamic analysis, applications that can examine registry, file, network and process events are installed in the system, and their behavior is examined by running malicious software.

While doing dynamic analysis, you should carefully examine the following events.

1. Network Connections
2. File Events
3. Process Events
4. Registry Events

![process monitor tool](https://ld-images-2.s3.us-east-2.amazonaws.com/Malware+Analysis+Fundamentals/images/static-analysis-vs-dynamic-analysis.png)### **29 Addresses to Analyze Malware Faster**

We constantly spend time analyzing malware. We have listed 29 addresses that can be useful for **blue team** members to use time more effectively:

- [Anlyz](https://sandbox.anlyz.io/)
- [Any.run](https://sandbox.anlyz.io/)
- [Comodo Valkyrie](https://valkyrie.comodo.com/)
- [Cuckoo](https://sandbox.pikker.ee/)
- [Hybrid Analysis](http://www.hybrid-analysis.com/)
- [Intezer Analyze](https://www.intezer.com/)
- [SecondWrite Malware Deepview](https://www.secondwrite.com/)
- [Jevereg](http://jevereg.amnpardaz.com/)
- [IObit Cloud](http://cloud.iobit.com/)
- [BinaryGuard](http://www.binaryguard.com/)
- [BitBlaze](http://bitblaze.cs.berkeley.edu/)
- [SandDroid](http://sanddroid.xjtu.edu.cn/)
- [Joe Sandbox](https://www.joesandbox.com/#windows)
- [AMAaaS](https://amaaas.com/)
- [IRIS-H](https://iris-h.services/pages/dashboard#/pages/dashboard)
- [Gatewatcher Intelligence](https://intelligence.gatewatcher.com/)
- [Hatching Triage](https://tria.ge/) 
- [InQuest Labs](https://labs.inquest.net/dfi)
- [Manalyzer](https://manalyzer.org/)
- [SandBlast Analysis](https://threatpoint.checkpoint.com/ThreatPortal/emulation)
- [SNDBOX](https://app.sndbox.com/)
- [firmware](http://firmware.re/)
- [opswat](https://metadefender.opswat.com/?lang=en)
- [virusade](http://virusade.com/)
- [virustotal](https://www.virustotal.com/gui/)
- [malware config](https://malwareconfig.com/)
- [malware hunter team](https://id-ransomware.malwarehunterteam.com/)
- [virscan](http://www.virscan.org/) 
- [jotti](https://virusscan.jotti.org/it)